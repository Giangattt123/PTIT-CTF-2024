from Crypto.Util.number import *
from math import gcd

# Thông tin từ server
n1 = 26298140872753691442627988568757644332383708175570484126445496046025997820131790107586224306288680153466014255879645746994255638986849371154980582823374429803432625097398370721237288983711034019903034551530318221749089792047831558320037743263759356010177669569146437283081273710623922688869863131209569316059389785421683363878566873675998572470121232400479723712704901434021178624173019786231743253574634107931228743187221711518043977310493682710513527302401396616752341968252367228421776249719600673072469427244136337935366277966465324145148191185126001422063075854443970940100666302703288340243140929268591758406549
c1 = 18214750130786991700575145457480667927354502058544506162821405890317835939227844606256377717409493301129330069805076756776078699680405412022034518292495810150402548387677092004883350145657390519482953164073526301673708187506958947421329857665434870783884817155519833861930509944604060932951848881191777272865490636485314408770403378705535237226514107142367453954536594251127602151091757357449784258296166364663064740272356699470435397545597896769701305605919040962466049037409482407243212739874242615612856337519784039439641261794451294559064862754130937910572126390882755605637547125583428490894228682190367962152177

n2 = 21469458786427751848524750287032897960109024657651223974145291551422455604603072965941880095064351512815538750614182812206157273910399747043797300277136338209925142677933873181300254183125379680843268164558720608372346068602076488713203285859662008095665375690496022122749947252506991430673612126064658837983405617770312205132594096649214122042625738040525670427340161908638702599643036109638125315986937019771369613709560386709606457851801954425064648520964998552913465053355251711859141701324022419889080069346675791590758865059807701648688551992233106726335073926287117368003831386575729740842671442339307252284251
c2 = 18824349860878686551699620582270248007678561166454793194605835127320441048569013772417085446437201003768494961814112750310930467357587911414140197391391400573264009378739319480580708439181393624488087130722381810049637892180960137509862932295267650962422708106776186391496826767335269203301587347335026232391045716498876179718551243160057815071506055299417456535706114616313375668660462953501902626470066712227931440867380279173542994913807999461540677264885143886565704969480223409215061540838687389491802504480551213055784125967023047748654168019198368888819946741963281583701556070590610688899614933915053701264015

e = 65537

# Tìm p
p = gcd(n1, n2)

# Tìm q và r
q = n1 // p
r = n2 // p

# Tính d1 và d2
phi1 = (p - 1) * (q - 1)
phi2 = (p - 1) * (r - 1)
d1 = pow(e, -1, phi1)
d2 = pow(e, -1, phi2)

# Giải mã message và flag
m1 = pow(c1, d1, n1)
message = long_to_bytes(m1).decode()

m2 = pow(c2, d2, n2)
flag = long_to_bytes(m2).decode()

print(f"Decrypted message: {message}")
print(f"Decrypted flag: {flag}")
